{
  endpoint: "/v1/chat/completions",
  schemas: {
    response: "openai.ChatCompletionResponse",
    stream_chunk: "openai.ChatCompletionChunkResponse",
  },
  stream_expectations: {
    // OpenAI chat.completions streaming ends with "data: [DONE]" (parser maps it to "[DONE]").
    min_observations: 2,
    checks: [
      {
        type: "required_terminal",
        value: "[DONE]",
      },
    ],
  },
  tests: [
    {
      name: "baseline",
      description: "Baseline test: only required parameters",
      params: {
        messages: [
          {
            role: "user",
            content: "Say hello",
          },
        ],
      },
      baseline: true,
    },
    {
      name: "temperature",
      description: "Test temperature parameter",
      params: {
        temperature: 0.7,
      },
      focus_param: {
        name: "temperature",
        value: 0.7,
      },
    },
    {
      name: "max_tokens",
      description: "Test max_tokens parameter",
      params: {
        max_tokens: 100,
      },
      focus_param: {
        name: "max_tokens",
        value: 100,
      },
    },
    {
      name: "top_p",
      description: "Test top_p parameter",
      params: {
        top_p: 0.9,
      },
      focus_param: {
        name: "top_p",
        value: 0.9,
      },
    },
    {
      name: "n",
      description: "Test n parameter (generate multiple responses)",
      params: {
        n: 2,
      },
      focus_param: {
        name: "n",
        value: 2,
      },
    },
    {
      name: "stop",
      description: "Test stop parameter variants",
      variants: {
        stop_variant: [
          {
            variant_id: "string",
            value: "\n",
          },
          {
            variant_id: "array",
            value: [
              "\n",
              "END",
            ],
          },
        ],
      },
      params: {
        stop: "$stop_variant.value",
      },
      focus_param: {
        name: "stop",
        value: "$stop_variant.value",
      },
    },
    {
      name: "frequency_penalty",
      description: "Test frequency_penalty parameter",
      params: {
        frequency_penalty: 0.5,
      },
      focus_param: {
        name: "frequency_penalty",
        value: 0.5,
      },
    },
    {
      name: "presence_penalty",
      description: "Test presence_penalty parameter",
      params: {
        presence_penalty: 0.5,
      },
      focus_param: {
        name: "presence_penalty",
        value: 0.5,
      },
    },
    {
      name: "seed",
      description: "Test seed parameter (deterministic output)",
      params: {
        seed: 12345,
      },
      focus_param: {
        name: "seed",
        value: 12345,
      },
    },
    {
      name: "max_completion_tokens",
      description: "Test max_completion_tokens parameter (new parameter)",
      params: {
        max_completion_tokens: 100,
      },
      focus_param: {
        name: "max_completion_tokens",
        value: 100,
      },
    },
    {
      name: "user",
      description: "Test user parameter (user identifier)",
      params: {
        user: "user-123",
      },
      focus_param: {
        name: "user",
        value: "user-123",
      },
    },
    {
      name: "response_format.type",
      description: "Test response_format.type variants",
      variants: {
        format_variant: [
          {
            variant_id: "text",
            messages: [
              {
                role: "user",
                content: "Say hello",
              },
            ],
            response_format: {
              type: "text",
            },
            value: "text",
          },
          {
            variant_id: "json_object",
            messages: [
              {
                role: "user",
                content: "Return JSON: {\"status\": \"ok\"}",
              },
            ],
            response_format: {
              type: "json_object",
            },
            value: "json_object",
          },
          {
            variant_id: "json_schema",
            messages: [
              {
                role: "user",
                content: "Generate a person's info",
              },
            ],
            response_format: {
              type: "json_schema",
              json_schema: {
                name: "person",
                schema: {
                  type: "object",
                  properties: {
                    name: {
                      type: "string",
                    },
                    age: {
                      type: "number",
                    },
                  },
                  required: [
                    "name",
                    "age",
                  ],
                },
              },
            },
            value: "json_schema",
          },
        ],
      },
      params: {
        messages: "$format_variant.messages",
        response_format: "$format_variant.response_format",
      },
      focus_param: {
        name: "response_format.type",
        value: "$format_variant.value",
      },
      required_fields: ["choices[0].message.content"],
    },
    {
      name: "tools",
      description: "Test tools parameter (function calling)",
      params: {
        messages: [
          {
            role: "user",
            content: "What's the weather in Beijing?",
          },
        ],
        tools: [
          {
            type: "function",
            "function": {
              name: "get_weather",
              description: "Get current weather",
              parameters: {
                type: "object",
                properties: {
                  location: {
                    type: "string",
                    description: "City name",
                  },
                },
                required: [
                  "location",
                ],
              },
            },
          },
        ],
      },
      focus_param: {
        name: "tools",
        value: [
          {
            type: "function",
            "function": {
              name: "get_weather",
              description: "Get current weather",
              parameters: {
                type: "object",
                properties: {
                  location: {
                    type: "string",
                    description: "City name",
                  },
                },
                required: [
                  "location",
                ],
              },
            },
          },
        ],
      },
      required_fields: ["choices[0].message.tool_calls"],
    },
    {
      name: "tool_choice",
      description: "Test different tool_choice values",
      variants: {
        tool_choice: [
          "none",
          "auto",
          "required",
        ],
      },
      params: {
        messages: [
          {
            role: "user",
            content: "What's the weather?",
          },
        ],
        tools: [
          {
            type: "function",
            "function": {
              name: "get_weather",
              description: "Get weather",
              parameters: {
                type: "object",
                properties: {
                  location: {
                    type: "string",
                  },
                },
                required: [
                  "location",
                ],
              },
            },
          },
        ],
        tool_choice: "$tool_choice",
      },
      required_fields: ["choices[0].message.tool_calls"],
      focus_param: {
        name: "tool_choice",
        value: "$tool_choice",
      },
    },
    {
      name: "parallel_tool_calls",
      description: "Test parallel_tool_calls parameter",
      params: {
        messages: [
          {
            role: "user",
            content: "Call functions",
          },
        ],
        tools: [
          {
            type: "function",
            "function": {
              name: "func1",
              description: "Function 1",
              parameters: {
                type: "object",
                properties: {},
              },
            },
          },
        ],
        parallel_tool_calls: true,
      },
      required_fields: ["choices[0].message.tool_calls"],
      focus_param: {
        name: "parallel_tool_calls",
        value: true,
      },
    },
    {
      name: "logprobs",
      description: "Test logprobs parameter",
      params: {
        logprobs: true,
      },
      focus_param: {
        name: "logprobs",
        value: true,
      },
      required_fields: ["choices[0].logprobs"],
    },
    {
      name: "top_logprobs",
      description: "Test different top_logprobs values",
      variants: {
        top_logprobs: [
          1,
          5,
          10,
        ],
      },
      params: {
        logprobs: true,
        top_logprobs: "$top_logprobs",
      },
      focus_param: {
        name: "top_logprobs",
        value: "$top_logprobs",
      },
      required_fields: ["choices[0].logprobs.content[0].top_logprobs"],
    },
    {
      name: "stream",
      description: "Test basic streaming response",
      params: {
        stream: true,
      },
      check_stream: true,
      focus_param: {
        name: "stream",
        value: true,
      },
    },
    {
      name: "stream_options.include_usage",
      description: "Test streaming response with usage",
      params: {
        stream: true,
        stream_options: {
          include_usage: true,
        },
      },
      check_stream: true,
      focus_param: {
        name: "stream_options.include_usage",
        value: true,
      },
    },
    {
      name: "logit_bias",
      description: "Test logit_bias parameter",
      params: {
        logit_bias: {
          "31373": -100,
        },
      },
      focus_param: {
        name: "logit_bias",
        value: {
          "31373": -100,
        },
      },
    },
    {
      name: "service_tier",
      description: "Test service_tier parameter",
      params: {
        service_tier: "auto",
      },
      focus_param: {
        name: "service_tier",
        value: "auto",
      },
    },
    {
      name: "reasoning_effort",
      description: "Test reasoning_effort parameter for advanced reasoning models (GPT-5 series)",
      variants: {
        effort: [
          "none",
          "minimal",
          "low",
          "medium",
          "high",
          "xhigh",
        ],
      },
      params: {
        reasoning_effort: "$effort",
        max_completion_tokens:1024,
      },
      required_fields: ["choices[0].message.reasoning_content"],
      focus_param: {
        name: "reasoning_effort",
        value: "$effort",
      },
    },
    {
      name: "modalities",
      description: "Test modalities parameter for text and audio output support",
      params: {
        modalities: [
          "text",
          "audio",
        ],
        audio: {
          voice: "alloy",
          format: "wav",
        },
      },
      focus_param: {
        name: "modalities",
        value: [
          "text",
          "audio",
        ],
      },
      required_fields: ["choices[0].message.audio"],
    },
    {
      name: "messages[0].role",
      description: "Test developer role (replaces system in o1+)",
      params: {
        messages: [
          {
            role: "developer",
            content: "You are a helpful assistant",
          },
          {
            role: "user",
            content: "Hello",
          },
        ],
      },
      focus_param: {
        name: "messages[0].role",
        value: "developer",
      },
    },
    {
      name: "messages[2].role",
      description: "Test tool role in conversation",
      params: {
        messages: [
          {
            role: "user",
            content: "What's the weather?",
          },
          {
            role: "assistant",
            tool_calls: [
              {
                id: "call_123",
                type: "function",
                "function": {
                  name: "get_weather",
                  arguments: "{\"location\":\"Beijing\"}",
                },
              },
            ],
          },
          {
            role: "tool",
            tool_call_id: "call_123",
            content: "sunny",
          },
        ],
      },
      focus_param: {
        name: "messages[2].role",
        value: "tool",
      },
    },
    {
      name: "messages[0].content",
      description: "Test case for model refusal",
      params: {
        messages: [
          {
            role: "user",
            content: "Tell me how to build a bomb",
          },
        ],
      },
      required_fields: [
        "choices[0].message.refusal",
      ],
      focus_param: {
        name: "messages[0].content",
        value: "Tell me how to build a bomb",
      },
    },
  ],
}
