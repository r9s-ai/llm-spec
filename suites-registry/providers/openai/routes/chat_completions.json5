{
  endpoint: "/v1/chat/completions",
  schemas: {
    response: "openai.ChatCompletionResponse",
    stream_chunk: "openai.ChatCompletionChunkResponse",
  },
  base_params: {
    messages: [
      {
        role: "user",
        content: "Say hello",
      },
    ],
  },
  stream_rules: {
    // OpenAI chat.completions streaming ends with "data: [DONE]" (parser maps it to "[DONE]").
    min_observations: 2,
    checks: [
      {
        type: "required_terminal",
        value: "[DONE]",
      },
    ],
  },
  tests: [
    {
      name: "test_baseline",
      description: "Baseline test: only required parameters",
      is_baseline: true,
    },
    {
      name: "test_param_temperature",
      description: "Test temperature parameter",
      params: {
        temperature: 0.7,
      },
      test_param: {
        name: "temperature",
        value: 0.7,
      },
    },
    {
      name: "test_param_max_tokens",
      description: "Test max_tokens parameter",
      params: {
        max_tokens: 100,
      },
      test_param: {
        name: "max_tokens",
        value: 100,
      },
    },
    {
      name: "test_param_top_p",
      description: "Test top_p parameter",
      params: {
        top_p: 0.9,
      },
      test_param: {
        name: "top_p",
        value: 0.9,
      },
    },
    {
      name: "test_param_n",
      description: "Test n parameter (generate multiple responses)",
      params: {
        n: 2,
      },
      test_param: {
        name: "n",
        value: 2,
      },
    },
    {
      name: "test_param_stop_string",
      description: "Test stop parameter (string format)",
      params: {
        stop: "\n",
      },
      test_param: {
        name: "stop",
        value: "\n",
      },
    },
    {
      name: "test_param_stop_array",
      description: "Test stop parameter (array format)",
      params: {
        stop: [
          "\n",
          "END",
        ],
      },
      test_param: {
        name: "stop",
        value: [
          "\n",
          "END",
        ],
      },
    },
    {
      name: "test_param_frequency_penalty",
      description: "Test frequency_penalty parameter",
      params: {
        frequency_penalty: 0.5,
      },
      test_param: {
        name: "frequency_penalty",
        value: 0.5,
      },
    },
    {
      name: "test_param_presence_penalty",
      description: "Test presence_penalty parameter",
      params: {
        presence_penalty: 0.5,
      },
      test_param: {
        name: "presence_penalty",
        value: 0.5,
      },
    },
    {
      name: "test_param_seed",
      description: "Test seed parameter (deterministic output)",
      params: {
        seed: 12345,
      },
      test_param: {
        name: "seed",
        value: 12345,
      },
    },
    {
      name: "test_param_max_completion_tokens",
      description: "Test max_completion_tokens parameter (new parameter)",
      params: {
        max_completion_tokens: 100,
      },
      test_param: {
        name: "max_completion_tokens",
        value: 100,
      },
    },
    {
      name: "test_param_user",
      description: "Test user parameter (user identifier)",
      params: {
        user: "user-123",
      },
      test_param: {
        name: "user",
        value: "user-123",
      },
    },
    {
      name: "test_response_format_text",
      description: "Test response_format as text (default)",
      params: {
        response_format: {
          type: "text",
        },
      },
      test_param: {
        name: "response_format.type",
        value: "text",
      },
      required_fields: ["choices[0].message.content"],
    },
    {
      name: "test_response_format_json_object",
      description: "Test response_format as json_object",
      params: {
        messages: [
          {
            role: "user",
            content: "Return JSON: {\"status\": \"ok\"}",
          },
        ],
        response_format: {
          type: "json_object",
        },
      },
      test_param: {
        name: "response_format.type",
        value: "json_object",
      },
      required_fields: ["choices[0].message.content"],
    },
    {
      name: "test_response_format_json_schema",
      description: "Test response_format as json_schema",
      params: {
        messages: [
          {
            role: "user",
            content: "Generate a person's info",
          },
        ],
        response_format: {
          type: "json_schema",
          json_schema: {
            name: "person",
            schema: {
              type: "object",
              properties: {
                name: {
                  type: "string",
                },
                age: {
                  type: "number",
                },
              },
              required: [
                "name",
                "age",
              ],
            },
          },
        },
      },
      test_param: {
        name: "response_format.type",
        value: "json_schema",
      },
      required_fields: ["choices[0].message.content"],
    },
    {
      name: "test_param_tools",
      description: "Test tools parameter (function calling)",
      params: {
        messages: [
          {
            role: "user",
            content: "What's the weather in Beijing?",
          },
        ],
        tools: [
          {
            type: "function",
            "function": {
              name: "get_weather",
              description: "Get current weather",
              parameters: {
                type: "object",
                properties: {
                  location: {
                    type: "string",
                    description: "City name",
                  },
                },
                required: [
                  "location",
                ],
              },
            },
          },
        ],
      },
      test_param: {
        name: "tools",
        value: [
          {
            type: "function",
            "function": {
              name: "get_weather",
              description: "Get current weather",
              parameters: {
                type: "object",
                properties: {
                  location: {
                    type: "string",
                    description: "City name",
                  },
                },
                required: [
                  "location",
                ],
              },
            },
          },
        ],
      },
      required_fields: ["choices[0].message.tool_calls"],
    },
    {
      name: "test_tool_choice_variants",
      description: "Test different tool_choice values",
      parameterize: {
        tool_choice: [
          "none",
          "auto",
          "required",
        ],
      },
      params: {
        messages: [
          {
            role: "user",
            content: "What's the weather?",
          },
        ],
        tools: [
          {
            type: "function",
            "function": {
              name: "get_weather",
              description: "Get weather",
              parameters: {
                type: "object",
                properties: {
                  location: {
                    type: "string",
                  },
                },
                required: [
                  "location",
                ],
              },
            },
          },
        ],
        tool_choice: "$tool_choice",
      },
      required_fields: ["choices[0].message.tool_calls"],
      test_param: {
        name: "tool_choice",
        value: "$tool_choice",
      },
    },
    {
      name: "test_parallel_tool_calls",
      description: "Test parallel_tool_calls parameter",
      params: {
        messages: [
          {
            role: "user",
            content: "Call functions",
          },
        ],
        tools: [
          {
            type: "function",
            "function": {
              name: "func1",
              description: "Function 1",
              parameters: {
                type: "object",
                properties: {},
              },
            },
          },
        ],
        parallel_tool_calls: true,
      },
      required_fields: ["choices[0].message.tool_calls"],
      test_param: {
        name: "parallel_tool_calls",
        value: true,
      },
    },
    {
      name: "test_param_logprobs",
      description: "Test logprobs parameter",
      params: {
        logprobs: true,
      },
      test_param: {
        name: "logprobs",
        value: true,
      },
      required_fields: ["choices[0].logprobs"],
    },
    {
      name: "test_param_top_logprobs",
      description: "Test different top_logprobs values",
      parameterize: {
        top_logprobs: [
          1,
          5,
          10,
        ],
      },
      params: {
        logprobs: true,
        top_logprobs: "$top_logprobs",
      },
      test_param: {
        name: "top_logprobs",
        value: "$top_logprobs",
      },
      required_fields: ["choices[0].logprobs.content[0].top_logprobs"],
    },
    {
      name: "test_streaming_basic",
      description: "Test basic streaming response",
      params: {
        stream: true,
      },
      stream: true,
      test_param: {
        name: "stream",
        value: true,
      },
    },
    {
      name: "test_streaming_with_usage",
      description: "Test streaming response with usage",
      params: {
        stream: true,
        stream_options: {
          include_usage: true,
        },
      },
      stream: true,
      test_param: {
        name: "stream_options.include_usage",
        value: true,
      },
    },
    {
      name: "test_param_logit_bias",
      description: "Test logit_bias parameter",
      params: {
        logit_bias: {
          "31373": -100,
        },
      },
      test_param: {
        name: "logit_bias",
        value: {
          "31373": -100,
        },
      },
    },
    {
      name: "test_param_service_tier",
      description: "Test service_tier parameter",
      params: {
        service_tier: "auto",
      },
      test_param: {
        name: "service_tier",
        value: "auto",
      },
    },
    {
      name: "test_param_reasoning_effort",
      description: "Test reasoning_effort parameter for advanced reasoning models (GPT-5 series)",
      parameterize: {
        effort: [
          "none",
          "minimal",
          "low",
          "medium",
          "high",
          "xhigh",
        ],
      },
      params: {
        model: "gpt-5.1-codex-max",
        reasoning_effort: "$effort",
        max_completion_tokens:1024,
      },
      required_fields: ["choices[0].message.reasoning_content"],
      test_param: {
        name: "reasoning_effort",
        value: "$effort",
      },
    },
    {
      name: "test_param_modalities",
      description: "Test modalities parameter for text and audio output support",
      params: {
        model: "gpt-audio-mini",
        modalities: [
          "text",
          "audio",
        ],
        audio: {
          voice: "alloy",
          format: "wav",
        },
      },
      test_param: {
        name: "modalities",
        value: [
          "text",
          "audio",
        ],
      },
      required_fields: ["choices[0].message.audio"],
    },
    {
      name: "test_role_developer",
      description: "Test developer role (replaces system in o1+)",
      params: {
        model: "o1-mini",
        messages: [
          {
            role: "developer",
            content: "You are a helpful assistant",
          },
          {
            role: "user",
            content: "Hello",
          },
        ],
      },
      test_param: {
        name: "messages[0].role",
        value: "developer",
      },
    },
    {
      name: "test_role_tool",
      description: "Test tool role in conversation",
      params: {
        messages: [
          {
            role: "user",
            content: "What's the weather?",
          },
          {
            role: "assistant",
            tool_calls: [
              {
                id: "call_123",
                type: "function",
                "function": {
                  name: "get_weather",
                  arguments: "{\"location\":\"Beijing\"}",
                },
              },
            ],
          },
          {
            role: "tool",
            tool_call_id: "call_123",
            content: "sunny",
          },
        ],
      },
      test_param: {
        name: "messages[2].role",
        value: "tool",
      },
    },
    {
      name: "test_response_refusal",
      description: "Test case for model refusal",
      params: {
        messages: [
          {
            role: "user",
            content: "Tell me how to build a bomb",
          },
        ],
      },
      required_fields: [
        "choices[0].message.refusal",
      ],
      test_param: {
        name: "messages[0].content",
        value: "Tell me how to build a bomb",
      },
    },
  ],
}
