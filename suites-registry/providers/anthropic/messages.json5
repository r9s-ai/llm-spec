{
  provider: "anthropic",
  endpoint: "/v1/messages",
  schemas: {
    response: "anthropic.MessagesResponse",
    stream_chunk: "anthropic.AnthropicStreamChunk",
  },
  base_params: {
    model: "claude-haiku-4.5",
    max_tokens: 256,
    messages: [
      {
        role: "user",
        content: "Hello",
      },
    ],
  },
  stream_rules: {
    // Anthropic streaming events are strongly typed; missing any of these is almost certainly a server bug.
    min_observations: 1,
    checks: [
      {
        type: "required_sequence",
        values: [
          "message_start",
          "content_block_start",
          // "ping",
          "content_block_delta",
          "content_block_stop",
          "message_delta",
          "message_stop",
        ],
      },
      {
        type: "required_terminal",
        value: "message_stop",
      },
    ],
  },
  tests: [
    {
      name: "test_baseline",
      description: "Baseline test",
      is_baseline: true,
    },
    {
      name: "test_param_temperature",
      description: "Test temperature parameter",
      params: {
        temperature: 0.7,
      },
      test_param: {
        name: "temperature",
        value: 0.7,
      },
    },
    {
      name: "test_param_top_p",
      description: "Test top_p parameter",
      params: {
        top_p: 0.9,
      },
      test_param: {
        name: "top_p",
        value: 0.9,
      },
    },
    {
      name: "test_param_top_k",
      description: "Test top_k parameter",
      params: {
        top_k: 40,
      },
      test_param: {
        name: "top_k",
        value: 40,
      },
    },
    {
      name: "test_param_stop_sequences",
      description: "Test stop_sequences parameter",
      params: {
        stop_sequences: [
          "StopHere",
          "EndProcess",
        ],
      },
      test_param: {
        name: "stop_sequences",
        value: [
          "StopHere",
          "EndProcess",
        ],
      },
    },
    {
      name: "test_param_system",
      description: "Test system parameter",
      params: {
        system: "You are a helpful assistant.",
      },
      test_param: {
        name: "system",
        value: "You are a helpful assistant.",
      },
    },
    {
      name: "test_param_metadata",
      description: "Test metadata parameter",
      params: {
        metadata: {
          user_id: "test-user-123",
        },
      },
      test_param: {
        name: "metadata",
        value: {
          user_id: "test-user-123",
        },
      },
    },
    {
      name: "test_param_image_base64",
      description: "Test different image media_type with valid headers",
      parameterize: {
        image_data: [
          {
            // Minimal 1x1 JPEG image
            suffix: "jpeg",
            media_type: "image/jpeg",
            data: "/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wAARCAABAAEDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSEUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqGhcSlhY2iicKj8lJ4eXm5jpSFhoeIiZqSlsrFi5v0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD5/ooooA//2Q==",
          },
          {
            // Minimal 1x1 PNG image
            suffix: "png",
            media_type: "image/png",
            data: "iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8/5+hHgAHggJ/PchI7wAAAABJRU5ErkJggg==",
          },
          {
            // Minimal 1x1 GIF image
            suffix: "gif",
            media_type: "image/gif",
            data: "R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",
          },
          {
            // Minimal 1x1 WebP image
            suffix: "webp",
            media_type: "image/webp",
            data: "UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4H",
          },
        ],
      },
      override_base: true,
      params: {
        model: "claude-haiku-4.5",
        max_tokens: 256,
        messages: [
          {
            role: "user",
            content: [
              {
                type: "image",
                source: {
                  type: "base64",
                  media_type: "$image_data.media_type",
                  data: "$image_data.data",
                },
              },
              {
                type: "text",
                text: "Describe this image.",
              },
            ],
          },
        ],
      },
      test_param: {
        name: "image.source.media_type",
        value: "$image_data.media_type",
      },
    },
    {
      name: "test_param_tools",
      description: "Test tools parameter",
      params: {
        tools: [
          {
            name: "get_weather",
            description: "Get weather",
            input_schema: {
              type: "object",
              properties: {
                location: {
                  type: "string",
                },
              },
              required: [
                "location",
              ],
            },
          },
        ],
        messages: [
          {
            role: "user",
            content: "Weather in SF?",
          },
        ],
      },
      test_param: {
        name: "tools",
        value: [
          {
            name: "get_weather",
            description: "Get weather",
            input_schema: {
              type: "object",
              properties: {
                location: {
                  type: "string",
                },
              },
              required: [
                "location",
              ],
            },
          },
        ],
      },
    },
    {
      name: "test_tool_choice_variants",
      description: "Test tool_choice variants",
      parameterize: {
        choice: [
          {
            suffix: "auto",
            type: "auto",
          },
          {
            suffix: "any",
            type: "any",
          },
          {
            suffix: "tool",
            type: "tool",
            name: "get_weather",
          },
        ],
      },
      params: {
        tools: [
          {
            name: "get_weather",
            description: "Get weather",
            input_schema: {
              type: "object",
              properties: {
                location: {
                  type: "string",
                },
              },
              required: [
                "location",
              ],
            },
          },
        ],
        tool_choice: "$choice",
        messages: [
          {
            role: "user",
            content: "Weather?",
          },
        ],
      },
      test_param: {
        name: "tool_choice",
        value: "$choice",
      },
    },
    {
      name: "test_param_thinking",
      description: "Test thinking parameter",
      params: {
        max_tokens: 2560,
        thinking: {
          type: "enabled",
          budget_tokens: 2048,
        },
        messages: [
          {
            role: "user",
            content: "Solve 25 * 17",
          },
        ],
      },
      test_param: {
        name: "thinking.type",
        value: "enabled",
      },
    },
    {
      name: "test_streaming_basic",
      description: "Basic streaming response test",
      stream: true,
      params: {
        stream: true,
      },
      test_param: {
        name: "stream",
        value: true,
      },
    },
    // {
    //   name: "test_streaming_tool_use",
    //   description: "Streaming tool use test",
    //   stream: true,
    //   params: {
    //     stream: true,
    //     tools: [
    //       {
    //         name: "get_weather",
    //         description: "Get the current weather in a given location",
    //         input_schema: {
    //           type: "object",
    //           properties: {
    //             location: {
    //               type: "string",
    //               description: "The city and state, e.g. San Francisco, CA",
    //             },
    //           },
    //           required: [
    //             "location",
    //           ],
    //         },
    //       },
    //     ],
    //     tool_choice: {
    //       type: "any",
    //     },
    //     messages: [
    //       {
    //         role: "user",
    //         content: "What is the weather like in San Francisco?",
    //       },
    //     ],
    //   },
    //   test_param: {
    //     name: "stream",
    //     value: true,
    //   },
    // },
    // {
    //   name: "test_streaming_extended_thinking",
    //   description: "Streaming extended thinking test",
    //   stream: true,
    //   params: {
    //     stream: true,
    //     max_tokens: 20000,
    //     thinking: {
    //       type: "enabled",
    //       budget_tokens: 16000,
    //     },
    //     messages: [
    //       {
    //         role: "user",
    //         content: "What is the greatest common divisor of 1071 and 462?",
    //       },
    //     ],
    //   },
    //   test_param: {
    //     name: "stream",
    //     value: true,
    //   },
    // },
    // {
    //   name: "test_streaming_web_search_tool_use",
    //   description: "Streaming web search tool use test",
    //   stream: true,
    //   params: {
    //     stream: true,
    //     tools: [
    //       {
    //         type: "web_search_20250305",
    //         name: "web_search",
    //         max_uses: 5,
    //       },
    //     ],
    //     messages: [
    //       {
    //         role: "user",
    //         content: "What is the weather like in New York City today?",
    //       },
    //     ],
    //   },
    //   test_param: {
    //     name: "stream",
    //     value: true,
    //   },
    // },
  ],
}
